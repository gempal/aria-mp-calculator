<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MP Recovery Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 420px;
            margin: 30px auto;
            padding: 20px;
            background: #f4f4f4;
            border-radius: 12px;
        }

        h2 {
            text-align: center;
            margin-top: 0;
        }

        label {
            display: block;
            margin-top: 12px;
            font-weight: bold;
        }

        select,
        input {
            width: 100%;
            box-sizing: border-box;
            padding: 8px;
            font-size: 14px;
            margin-top: 4px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background: #fff;
        }

        .result {
            margin-top: 14px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 6px;
            padding: 10px 12px;
        }

        .row {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            align-items: baseline;
        }

        .row .label {
            font-weight: bold;
        }

        .row .value {
            font-variant-numeric: tabular-nums;
        }

        .muted {
            color: #666;
            font-size: 12px;
            margin-top: 6px;
        }
    </style>
</head>

<body>
    <h2>MP Recovery Calculator</h2>

    <label for="character">Character</label>
    <select id="character"></select>

    <label for="baseMP">Character Base MP</label>
    <input type="number" id="baseMP" readonly />

    <label for="hits"># of Hits to Ult</label>
    <input type="number" id="hits" min="1" max="10" value="4" />

    <label for="weaponMP">Aria Weapon MP Recovery %</label>
    <select id="weaponMP">
        <option value="10">10%</option>
        <option value="15">15%</option>
        <option value="20">20%</option>
        <option value="25">25%</option>
        <option value="30" selected>30%</option>
        <option value="35">35%</option>
    </select>

    <br />

    <div class="result">
        <div class="row">
            <div class="label">MP Recovery % needed on stat window</div>
            <div class="value" id="mpRecovery">0.00</div>
        </div>
    </div>

    <script>
        const characters = {
            "Yuna": 170, "Baal": 110, "Adela": 170, "Crona": 170, "Maru": 130,
            "Amethyst": 130, "Heida": 130, "Elroa": 170, "Aisha": 170, "Hana": 170,
            "Isis": 150, "Charis": 130, "Aria": 130, "Dana": 150, "Selena": 170,
            "Rebecca": 170, "Dorothy": 150, "Dr. Hela": 130, "Veronika": 200, "Alice": 150,
            "Meilin": 150, "Eswood": 140, "Noel": 170, "Alisa": 150, "Clara": 170,
            "Capt J": 150, "Priscila": 150, "Maurice": 170, "Thea": 170, "Elly": 130,
            "Lua": 150, "Milla": 200, "Shannie": 110, "Fuuka": 200, "Neya": 130,
            "Garnet": 200, "Edelweiss": 130, "Nana": 150, "Hilda": 200, "Aurora": 170,
            "Emerald": 170, "Lilith": 130, "Blair": 170, "Sherrie": 170, "R character": 100,
            "Clodia": 90
        };

        // Elements
        const selChar = document.getElementById("character");
        const inpBase = document.getElementById("baseMP");
        const inpHits = document.getElementById("hits");
        const selWeapon = document.getElementById("weaponMP");
        const outBonus = document.getElementById("bonusMultiplier");
        const outMP = document.getElementById("mpRecovery");

        // Populate character dropdown
        Object.keys(characters).forEach(name => {
            const opt = document.createElement("option");
            opt.value = name;
            opt.textContent = name;
            selChar.appendChild(opt);
        });
        selChar.value = "Aria";
        inpBase.value = characters["Aria"];

        // Recalculate on change
        [selChar, inpHits, selWeapon].forEach(el => el.addEventListener("input", update));

        function update() {
            const baseMP = characters[selChar.value] || 0;
            inpBase.value = baseMP;
            const hits = Number(inpHits.value) || 0;
            const weaponPct = Number(selWeapon.value) || 0;

            // Excel-accurate formulas provided by you:
            // Bonus % = (1000 / (#Hits * (BaseMP + WeaponMP%)) - 1) * 100
            const bonusPct = (1000 / (hits * (baseMP + weaponPct)) - 1) * 100;

            // MP Recovery % (value) = BaseMP * (1 + Bonus%/100)
            const mpRecoveryValue = baseMP * (1 + (bonusPct / 100));

            outBonus.textContent = isFinite(bonusPct) ? bonusPct.toFixed(2) + "%" : "—";
            outMP.textContent = isFinite(mpRecoveryValue) ? mpRecoveryValue.toFixed(2) : "—";
        }

        update();
    </script>
</body>

</html>